{$CLEO .cs}
//-------------MAIN---------------

if 0@ == 1
then
    jump @camera_effect
end

if 0@ == 2
then
    jump @regen_texture
end

thread "dwregen"

const
    SPECIAL = 25@
end

25@ = -1

while true
    wait 0
    if or
        8184:   not actor $PLAYER_ACTOR health >= 15
        0ADC: test_cheat "reg"
    then
        if 
            8184:   not actor $PLAYER_ACTOR health >= 1
        then
            // Cj is dead
            repeat
                wait 1000
            until 0184:  actor $PLAYER_ACTOR health >= 50
            continue
        end
        0992: set_player $PLAYER_CHAR weapons_scrollable 0 
        01B9: set_actor $PLAYER_ACTOR armed_weapon_to 0 
        0223: set_actor $PLAYER_ACTOR health_to 500 
        02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1 
        0ACE: show_formatted_text_box "You're nearly dead~n~Tap R rapidly to hold Regeneration or Press Y to Regenerate now"
        32@ = 0
        while true
            wait 0
            0390: load_txd_dictionary 'dwload' 
            038F: load_texture "regblur" as 10
            038F: load_texture "regblur2" as 11
            
            015D: set_gamespeed 0.00001
            if or
                0AB0: 78 // N
                32@ >= 10
            then
                break
            end
            if 0AB0: 82 // R
            then
                03E6: remove_text_box 
                015D: set_gamespeed 1.0 
                02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
                0ACE: show_formatted_text_box "Mash R to hold regeneration~n~Press Y to regenerate now"
                call_scm_func @holdRegen 0
                06AF: set_player $PLAYER_CHAR sprint_mode 0
                break
            end 
        end
        015D: set_gamespeed 1.0
        03E6: remove_text_box 
        02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
        gosub @regen
        0223: set_actor $PLAYER_ACTOR health_to 500 
        if $93 == 0
        then
            0992: set_player $PLAYER_CHAR weapons_scrollable 1
        end
        repeat
            wait 0
            0AB4: 1@ = var 53
        until 1@ == 0
        02AB: set_actor $PLAYER_ACTOR immunities BP 0 FP 0 EP 0 CP 0 MP 0 
        0ACE: show_formatted_text_box "Regeneration completed"
    end 
    if 0ADC: test_cheat "ref"
    then
        run "regeneration.cs"
        end_custom_thread
    end
end

:regen
wait 0
0209: 1@ = random_int_in_ranges 0 290
if 1@ > 33 
then
    0209: 17@ = random_int_in_ranges 7 289    
else
    if 1@ == 0
    then
        17@ = 0
    else
        0209: 17@ = random_int_in_ranges 1000 1033
        
    end
end


0665: get_actor $PLAYER_ACTOR model_to 27@

//show_text "%d" 1100 27@
if 003B:   17@ == 27@ 
then
    jump @regen
end 
if 25@ == -1
then
    call_scm_func @load 2 id 27@ specAct 1 newID 27@ 
else
    call_scm_func @load 2 25@ 1 newID 27@   
end


if 17@ > 999
then
    0085: 25@ = 17@
else
    25@ = -1
end
0209: 1@ = random_int_in_ranges 0 4 // regen type

//show_text "%d" 1000 1@ 

call_scm_func @load 2 id 17@ specAct 2 newID 18@ 

00A0: store_actor $PLAYER_ACTOR position_to 2@ 3@ 4@ 
2@ -= 10.0
3@ -= 10.0
4@ -= 10.0
00A0: store_actor $PLAYER_ACTOR position_to 5@ 6@ 7@
5@ += 10.0
6@ += 10.0
7@ += 10.0
01E8: create_forbidden_for_cars_cube_cornerA 2@ 3@ 4@ cornerB 5@ 6@ 7@
022B: create_forbidden_for_peds_cube_cornerA 2@ 3@ 4@ cornerB 5@ 6@ 7@
0AB3: var 51 = 0 // take shades off
call_scm_func @regenerate 3 prev 27@ new 18@ type 0//1@
01E7: remove_forbidden_for_cars_cube_cornerA 2@ 3@ 4@ cornerB 5@ 6@ 7@
022A: remove_forbidden_for_peds_cube_cornerA 2@ 3@ 4@ cornerB 5@ 6@ 7@ 

call_scm_func @unload 1 18@ 
call_scm_func @unload 1 27@

return

:load
{
    0@ - skin ID
    1@ - number of special actor to put in

}
if and 
    0019: 0@ > 0 
    001B: 7 > 0@ 
then 
    0@ = 7 
end 

if or 
    0039: 0@ == 8 
    0039: 0@ == 42 
    0039: 0@ == 65 
    0039: 0@ == 74 
    0039: 0@ == 86 
    0039: 0@ == 208 
    0039: 0@ == 119 
    0039: 0@ == 149 
then 
    000A: 0@ += 1 
end 

if and 
    0019: 0@ > 264 
    001B: 274 > 0@ 
then 
    0@ = 274 
end 

if and 
    0019: 0@ > 288 
    001B: 1000 > 0@ 
then
    0@ = 1000 
end 

if 0019: 0@ > 1032 
then 
    0@ = 0 
end

if 0@ > 999
then
    if 0@ == 1000
    then
    023C: load_special_actor 'ANDRE' as 1@
    end
    if 0@ == 1001
    then
    023C: load_special_actor 'BBTHIN' as 1@
    end
    if 0@ == 1002
    then
    023C: load_special_actor  'BB'  as 1@
    end
    if 0@ == 1003
    then
    023C: load_special_actor 'CAT' as 1@
    end
    if 0@ == 1004
    then
    023C: load_special_actor 'CESAR' as 1@
    end
    if 0@ == 1005
    then
    023C: load_special_actor 'CLAUDE' as 1@
    end
    if 0@ == 1006
    then
    023C: load_special_actor 'DWAYNE' as 1@
    end
    if 0@ == 1007
    then
    023C: load_special_actor 'EMMET' as 1@
    end
    if 0@ == 1008
    then
    023C: load_special_actor 'FORELLI' as 1@
    end
    if 0@ == 1009
    then
    023C: load_special_actor 'JANITOR' as 1@
    end
    if 0@ == 1010
    then
    023C: load_special_actor 'JETHRO' as 1@
    end
    if 0@ == 1011
    then
    023C: load_special_actor 'JIZZY' as 1@
    end
    if 0@ == 1012
    then
    023C: load_special_actor 'HERN' as 1@
    end
    if 0@ == 1013
    then
    023C: load_special_actor 'KENDL' as 1@
    end
    if 0@ == 1014
    then
    023C: load_special_actor 'MACCER' as 1@
    end
    if 0@ == 1015
    then
    023C: load_special_actor 'MADDOGG' as 1@
    end
    if 0@ == 1016
    then
    023C: load_special_actor 'OGLOC' as 1@
    end
    if 0@ == 1017
    then
    023C: load_special_actor 'PAUL'  as 1@
    end
    if 0@ == 1018
    then
    023C: load_special_actor 'PULASKI' as 1@
    end
    if 0@ == 1019
    then
    023C: load_special_actor 'ROSE' as 1@
    end
    if 0@ == 1020
    then
    023C: load_special_actor 'RYDER2' as 1@
    end
    if 0@ == 1021
    then
    023C: load_special_actor 'RYDER3' as 1@
    end
    if 0@ == 1022
    then
    023C: load_special_actor 'SINDACO' as 1@
    end
    if 0@ == 1023
    then
    023C: load_special_actor 'SMOKE' as 1@
    end
    if 0@ == 1024
    then
    023C: load_special_actor 'SMOKEV' as 1@
    end
    if 0@ == 1025
    then
    023C: load_special_actor 'SUZIE' as 1@
    end
    if 0@ == 1026
    then
    023C: load_special_actor 'SWEET' as 1@
    end
    if 0@ == 1027
    then
    023C: load_special_actor 'TBONE' as 1@
    end
    if 0@ == 1028
    then
    023C: load_special_actor 'TENPEN' as 1@
    end
    if 0@ == 1029
    then
    023C: load_special_actor 'TORINO' as 1@
    end
    if 0@ == 1030
    then
    023C: load_special_actor 'TRUTH' as 1@
    end
    if 0@ == 1031
    then
    023C: load_special_actor 'WUZIMU' as 1@
    end
    if 0@ == 1032
    then
    023C: load_special_actor 'ZERO' as 1@
    end
       
    repeat
        wait 0
    until 023D:   special_actor 1@ loaded  
    
    if 1@ == 1
    then
        10@ = #SPECIAL01
    else
        if 1@ == 2
        then
            10@ = #SPECIAL02
        else
            10@ = #SPECIAL03
        end
    end
    0AB2: ret 1 10@
else
    model.Load(0@)
    038B: load_requested_models 

    repeat
        wait 0
    until model.Available(0@)  
    0085:  10@ = 0@
end
0AB2: ret 1 10@

:unload
if 0@ == #SPECIAL01
then
    0296: unload_special_actor 1 
else
    if 0@ == #SPECIAL02
    then
        0296: unload_special_actor 2
    else
        if 0@ == #SPECIAL03
        then
            0296: unload_special_actor 3
        else
            0249: release_model 0@
        end
    end        
end
0AB2: ret 0 


:holdRegen
06AF: set_player $PLAYER_CHAR sprint_mode 1
$Y_Royal_Casino = 0
04F7: status_text $Y_Royal_Casino type 1 line 1 GXT "REGBAR"
059C: enable_status_text $Y_Royal_Casino flashing 0
10@ = 0
1@ = 0
11@ = 1000
repeat
    32@ = 0
    repeat
        wait 0
        if 0AB0:  key_pressed 82
        then
            if 1@ == 0
            then
                1@ = 1
                if 32@ > 100
                then
                    32@ -= 100
                end
            else

            end
        else
            1@ = 0
        end
        03E3: set_texture_to_be_drawn_antialiased 1
        03F0: enable_text_draw 1
        0093: 12@ = integer 10@ to_float 
        12@ *= 2.57575757
        0092: 12@ = float 12@ to_integer 
 
        
        038D: draw_texture 11 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 12@
        
        0093: 15@ = integer 32@ to_float 
        0093: 13@ = integer 11@ to_float
        13@ /= 2.0
        if 0025: 15@ > 13@
        then
        //14@ = 128.0
            13@ *= -2.0
            0093: 14@ = integer 12@ to_float
            0073: 14@ /= 13@
            006B: 15@ *= 14@
            0092: 15@ = float 15@ to_integer
            005A: 15@ += 12@
            if 15@ < 0
            then
                15@ = 0
            end
            038D: draw_texture 10 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 15@
            //show_text "down %d %d" 1000 12@ 15@
        else
            13@ *= 2.0
            0093: 14@ = integer 12@ to_float
            0073: 14@ /= 13@
            006B: 15@ *= 14@
            0092: 15@ = float 15@ to_integer
            038D: draw_texture 10 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 15@
            //show_text "up %d %d" 1000 12@ 15@
        end 
        
    until 002D: 32@ >= 11@
    
    10@ += 1
    008A: $Y_Royal_Casino = 10@ // (int)
    
    0151: remove_status_text $Y_Royal_Casino
    04F7: status_text $Y_Royal_Casino type 1 line 1 GXT "REGBAR"
    059C: enable_status_text $Y_Royal_Casino flashing 0
    if 0AB0: 89 // Y
    then
        break
    end
    11@ -= 20
    if 11@ < 100
    then
        11@ = 100
    end
    
    
    //show_text "%d %d" 1000 10@ 11@
until 10@ >= 99
0151: remove_status_text $Y_Royal_Casino
03E3: set_texture_to_be_drawn_antialiased 1
//03F0: enable_text_draw 0
038D: draw_texture 11 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 255
038D: draw_texture 10 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 255 
run "regeneration.cs" 2 // regen textures blinking thread & post-regen immunities
0AB2: ret 0 


:regenerate
wait 0
{
    Params: 0@ - prev skin, 1@ - new skin, 2@ - reg type
}
0AB4: 30@ = var 53

if 30@ == 0
then
    run "regeneration.cs" 2
end

if 00DF:   actor $PLAYER_ACTOR driving 
then
    03C0: 30@ = actor $PLAYER_ACTOR car 
    0622: AS_actor $PLAYER_ACTOR bail_car 30@ 
    while true
        wait 0
        if and
            80DF:  NOT actor $PLAYER_ACTOR driving
            03EE:   player $PLAYER_CHAR controllable 
        then
            break
        end
    end
else
    repeat
        wait 0
    until 03EE:   player $PLAYER_CHAR controllable 
end

0085: 27@ = 0@ // previous skin 
0085: 28@ = 1@ // new skin
0085: 24@ = 2@ // regen type

//04D7: set_actor $PLAYER_ACTOR locked 1 
Player.CanMove($PLAYER_CHAR, 0)     
wait 500
009A: 30@ = create_actor_pedtype 21 model 27@ at -0.2326 -4.205 3.1172
009A: 25@ = create_actor_pedtype 21 model 27@ at -0.2326 -4.205 3.1172 // invisible fake ped
02AB: set_actor 25@ immunities BP 1 FP 1 EP 1 CP 1 MP 1 
02AB: set_actor 30@ immunities BP 1 FP 1 EP 1 CP 1 MP 1
0446: set_actor 25@ immune_to_headshots 1 
0446: set_actor 30@ immune_to_headshots 1 
0946: set_actor 25@ actions_uninterupted_by_weapon_fire 1 
0946: set_actor 30@ actions_uninterupted_by_weapon_fire 1  
0337: set_actor 25@ visibility 0 

0245: set_actor 30@ walk_style_to "MAN" 
0245: set_actor 25@ walk_style_to "MAN" 

0245: set_actor $PLAYER_ACTOR walk_style_to "MAN" 
0172: 1@ = actor $PLAYER_ACTOR Z_angle 
0173: set_actor 30@ Z_angle_to 1@
0173: set_actor 25@ Z_angle_to 1@
0619: enable_actor $PLAYER_ACTOR collision_detection 0
0619: enable_actor 25@ collision_detection 0
0350: set_actor 30@ maintain_position_when_attacked 1 
0350: set_actor 25@ maintain_position_when_attacked 1
05B9: task_pause 30@ time 999999
05B9: task_pause 25@ time 999999

04D7: set_actor 25@ locked 1
04D7: set_actor 30@ locked 1

00A0: store_actor $PLAYER_ACTOR position_to 1@ 2@ 3@  
09BC: set_char_coordinates_dont_warp_gang_no_offset 30@ at 1@ 2@ 3@
09BC: set_char_coordinates_dont_warp_gang_no_offset 25@ at 1@ 2@ 3@

09C7: change_player $PLAYER_CHAR model_to 28@
0D10: set_actor $PLAYER_ACTOR alpha 0 
//run "regeneration.cs" 1 0
wait 1500
// sync player's and fake ped's cords
0819: 10@ = actor $PLAYER_ACTOR distance_from_ground 
0819: 12@ = actor 30@ distance_from_ground
0063: 10@ -= 12@ // (float)
if 10@ >= 0.0
then
    if 10@ > 0.2
    then
        00A0: store_actor 30@ position_to 1@ 2@ 3@  
        09BC: set_char_coordinates_dont_warp_gang_no_offset $PLAYER_ACTOR at 1@ 2@ 3@
        09BC: set_char_coordinates_dont_warp_gang_no_offset 25@ at 1@ 2@ 3@
    end   
else
    10@ *= -1.0
    if 10@ > 0.2
    then
        00A0: store_actor $PLAYER_ACTOR position_to 1@ 2@ 3@  
        09BC: set_char_coordinates_dont_warp_gang_no_offset 30@ at 1@ 2@ 3@
        09BC: set_char_coordinates_dont_warp_gang_no_offset 25@ at 1@ 2@ 3@
    end
end 
    
0619: enable_actor 30@ collision_detection 0
0619: enable_actor 25@ collision_detection 1 
   
if 24@ == 0
then
    0687: clear_actor $PLAYER_ACTOR task 
    0687: clear_actor 30@ task 

    0812: AS_actor $PLAYER_ACTOR perform_animation "regen_Allons-y" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
    //0812: AS_actor 30@ perform_animation "regen_Allons-y" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
    //0605: actor $PLAYER_ACTOR perform_animation_sequence "regen_Allons-y" IFP_file "DW" 4.0 loop 0 0 0 0 time -1 // versionA 
    //0812: actor 30@ perform_animation_sequence "regen_Allons-y" IFP_file "DW" 4.0 loop 0 0 0 0 time -1 // versionA 
    0812: AS_actor 30@ perform_animation "regen_Allons-y" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB 


    Player.CanMove($PLAYER_CHAR, 1)
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
    066A: 10@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset 0.325 -0.15 0.55 rotation 90.0 0.0 0.0 flag 1 
    066A: 12@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset  -0.385 -0.15 0.55 rotation -90.0 0.0 0.0 flag 1 
    066A: 13@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset 0.0 -0.05 0.8 rotation 0.0 0.0 0.0 flag 1
    04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 0.0 0.0
    064B: 11@ = create_particle "explosion_small" at 1@ 2@ 3@ type 1
    04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 -0.03 0.7
    064B: 14@ = create_particle "flame" at 1@ 2@ 3@ type 1 
    0AAC: 15@ = load_audiostream "DWS\regen_a.mp3"
    0AAC: 17@ = load_audiostream "DWS\hbin.mp3"
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
    0AAD: set_audiostream 17@ perform_action 1
    :resetpoint
    16@ = 0
    32@ = 0
    repeat
        wait 0
        if 8184:   not actor $PLAYER_ACTOR health >= 15 
        then
            04D7: set_actor $PLAYER_ACTOR locked 0
            0687: clear_actor $PLAYER_ACTOR task
            0687: clear_actor 30@ task
            0321: kill_actor $PLAYER_ACTOR
            0321: kill_actor 30@
            0D10: set_actor $PLAYER_ACTOR alpha 255
            00A0: store_actor $PLAYER_ACTOR position_to 1@ 2@ 3@
            0460: set_camera_transverse_delay 0.0 time 60000 

            0160: set_camera_point_at 1@ 2@ 3@ mode 1 
            015F: set_camera_position 1@ 2@ 9999.9 rotation 0.0 0.0 0.0 
            show_text "Game over. Being a TimeLord doesn't mean being invincible." 20000
            0AAE: release_audiostream 15@
        
            0612: set_actor $PLAYER_ACTOR animation "regen_Allons-y"  paused 0 
            wait 5000
            fade 0 3000
            end_custom_thread
            0AB2: ret 0
        end
        
        if or
            8611:   not actor $PLAYER_ACTOR performing_animation "regen_Allons-y"
            8611:   not actor 30@ performing_animation "regen_Allons-y"
        then
            0687: clear_actor $PLAYER_ACTOR task 
            0687: clear_actor 30@ task
            wait 500     
            0812: AS_actor $PLAYER_ACTOR perform_animation "regen_Allons-y" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
            0812: AS_actor 30@ perform_animation "regen_Allons-y" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
            //0605: actor 30@ perform_animation_sequence "regen_Allons-y" IFP_file "DW" 4.0 loop 0 0 0 0 time -1 // versionA 
            32@ = 0
            0AAD: set_audiostream 15@ perform_action 0
            0AAD: set_audiostream 17@ perform_action 0
            0AAD: set_audiostream 17@ perform_action 1
        end
        
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0 
        0093: 26@ = integer 32@ to_float 
        26@ *= 0.031875
        0092: 26@ = float 26@ to_integer 
        0093: 27@ = integer 32@ to_float 
        27@ *= 0.022375
        0092: 27@ = float 27@ to_integer
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 26@ 27@ 0 radius 2.0 
        if and
            32@ > 6700
            16@ == 0
        then
            0AAD: set_audiostream 15@ perform_action 1
            16@ = 1
        end           
    until 32@ > 8000
    
    0223: set_actor $PLAYER_ACTOR health_to 500 
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1 
    
    064C: make_particle 14@ visible
    
    repeat
        wait 0 
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0 
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 255 179 0 radius 2.0
        
        if or
            8611:   not actor $PLAYER_ACTOR performing_animation "regen_Allons-y"
            8611:   not actor 30@ performing_animation "regen_Allons-y"
        then
            0687: clear_actor $PLAYER_ACTOR task 
            0687: clear_actor 30@ task 
            wait 500     
            0812: AS_actor $PLAYER_ACTOR perform_animation "regen_Allons-y" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
            0812: AS_actor 30@ perform_animation "regen_Allons-y" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
            //0605: actor 30@ perform_animation_sequence "regen_Allons-y" IFP_file "DW" 4.0 loop 0 0 0 0 time -1 // versionA 
            32@ = 0
            0AAD: set_audiostream 15@ perform_action 0
            0AAD: set_audiostream 17@ perform_action 0
            0AAD: set_audiostream 17@ perform_action 1
            064E: stop_particle 14@ 
            jump @resetpoint
        end
        0613: 26@ = actor $PLAYER_ACTOR animation "regen_Allons-y" time               
    until 26@ >= 0.54   
    064C: make_particle 11@ visible  
    064C: make_particle 10@ visible
    064C: make_particle 12@ visible  
    064C: make_particle 13@ visible
    call_scm_func @run_away 2 30@ 25@
    29@ = 0
    repeat
        wait 0
        
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0 
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 255 179 0 radius 2.0
        if and
            32@ > 11000
            29@ == 0
        then
            29@ += 1
            call_scm_func @run_away 5 30@ 25@ 1@ 2@ 3@ 
        end 
        if and
            32@ > 14000
            29@ == 1
        then
            29@ += 1
            call_scm_func @run_away 5 30@ 25@ 1@ 2@ 3@ 
        end 
        if and
            32@ > 17000
            29@ == 2
        then
            29@ += 1
            call_scm_func @run_away 5 30@ 25@ 1@ 2@ 3@ 
        end   
        if 32@ > 17000
        jf continue
        0093: 20@ = integer 32@ to_float 
        20@ -= 17000.0
        20@ *= 0.1275
        
        0092: 20@ = float 20@ to_integer
        20@ += 140
        if 20@ > 255
        then
            20@ = 255
        end 
        0D10: set_actor $PLAYER_ACTOR alpha 20@
        if actor.Defined(30@)
        then
            actor.DestroyWithFade(30@)
        end          
    until 32@ > 18500
    0650: destroy_particle 10@ 
    0650: destroy_particle 11@ 
    0650: destroy_particle 12@ 
    0650: destroy_particle 13@ 
    0650: destroy_particle 14@ 
    0D10: set_actor $PLAYER_ACTOR alpha 255
    0337: set_actor $PLAYER_ACTOR visibility 1
    repeat
        wait 0
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0        
        0093: 26@ = integer 32@ to_float 
        26@ -= 18500.0
        26@ *= -0.17
        26@ += 255.0
        0092: 26@ = float 26@ to_integer 
        0093: 27@ = integer 32@ to_float
        27@ -= 18500.0 
        27@ *= -0.1193
        27@ += 179.0
        0092: 27@ = float 27@ to_integer
        if 26@ < 0
        then
            26@ = 0
        end
        if 27@ < 0
        then
            27@ = 0
        end
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 26@ 27@ 0 radius 2.0
    until 32@ > 20000
    Actor.DestroyInstantly(25@)
    0619: enable_actor $PLAYER_ACTOR collision_detection 1
    04D7: set_actor $PLAYER_ACTOR locked 0
    wait 1500
    0AAE: release_audiostream 15@
    0AAE: release_audiostream 17@
    
    0AB2: ret 0
end
if 24@ == 1
then
    {0085: 27@ = 0@ // previous skin 
    0085: 28@ = 1@ // new skin
    
    04D7: set_actor $PLAYER_ACTOR locked 1 
    Player.CanMove($PLAYER_CHAR, 0)              
    
    wait 500
    009A: 30@ = create_actor_pedtype 21 model 27@ at -0.2326 -4.205 3.1172
    0245: set_actor 30@ walk_style_to "MAN" 
    0245: set_actor $PLAYER_ACTOR walk_style_to "MAN" 
    0172: 1@ = actor $PLAYER_ACTOR Z_angle 
    0173: set_actor 30@ Z_angle_to 1@
    0619: enable_actor $PLAYER_ACTOR collision_detection 0
    
    00A0: store_actor $PLAYER_ACTOR position_to 1@ 2@ 3@  
    09BC: set_char_coordinates_dont_warp_gang_no_offset 30@ at 1@ 2@ 3@
    
    09C7: change_player $PLAYER_CHAR model_to 28@
    0D10: set_actor $PLAYER_ACTOR alpha 0 
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
     //run "regeneration.cs" 1 0
    wait 1500
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
    0619: enable_actor 30@ collision_detection 0
    0619: enable_actor $PLAYER_ACTOR collision_detection 1} 
    
    0812: AS_actor $PLAYER_ACTOR perform_animation "regen_Geronimo" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
    0812: AS_actor 30@ perform_animation "regen_Geronimo" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
    Player.CanMove($PLAYER_CHAR, 1)
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1  
    066A: 10@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset 0.325 -0.15 0.55 rotation 45.0 -10.0 25.0 flag 1 
    066A: 12@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset  -0.385 -0.15 0.55 rotation -45.0 -10.0 25.0 flag 1 
    066A: 13@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset 0.0 -0.15 0.8 rotation 0.0 0.0 0.0 flag 1
    04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 0.0 0.0
    064B: 11@ = create_particle "explosion_small" at 1@ 2@ 3@ type 1
    04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 -0.15 0.7
    064B: 14@ = create_particle "flame" at 1@ 2@ 3@ type 1          
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1     
    32@ = 0
    repeat
        wait 0
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0 
        0093: 26@ = integer 32@ to_float 
        26@ *= 0.15454
        0092: 26@ = float 26@ to_integer 
        0093: 27@ = integer 32@ to_float 
        27@ *= 0.10848
        0092: 27@ = float 27@ to_integer
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 26@ 27@ 0 radius 2.0 
        0613: 26@ = actor $PLAYER_ACTOR animation "regen_Geronimo" time      
    until 26@ > 0.165
    
    064C: make_particle 14@ visible
    064C: make_particle 11@ visible  
    064C: make_particle 10@ visible
    064C: make_particle 12@ visible  
    064C: make_particle 13@ visible
    call_scm_func @run_away 2 30@ 25@
    29@ = 0
    repeat
        wait 0
    
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0 
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 255 179 0 radius 2.0
        if and
            32@ > 2000
            29@ == 0
        then
            29@ += 1
            call_scm_func @run_away 5 30@ 25@ 1@ 2@ 3@ 
        end 
        if and
            32@ > 5000
            29@ == 1
        then
            29@ += 1
            call_scm_func @run_away 5 30@ 25@ 1@ 2@ 3@ 
        end 
  
        if 32@ > 7000
        jf continue
        0093: 20@ = integer 32@ to_float 
        20@ -= 7000.0
        20@ *= 0.1275
        
        0092: 20@ = float 20@ to_integer
        20@ += 140
        if 20@ > 255
        then
            20@ = 255
        end 
        0D10: set_actor $PLAYER_ACTOR alpha 20@
        if actor.Defined(30@)
        then
            actor.DestroyWithFade(30@)
        end          
    until 32@ > 9000
    0650: destroy_particle 10@ 
    0650: destroy_particle 11@ 
    0650: destroy_particle 12@ 
    0650: destroy_particle 13@ 
    0650: destroy_particle 14@ 
    0D10: set_actor $PLAYER_ACTOR alpha 255
    0337: set_actor $PLAYER_ACTOR visibility 1
    repeat
        wait 0
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0        
        0093: 26@ = integer 32@ to_float 
        26@ -= 9500.0
        26@ *= -0.51
        26@ += 255.0
        0092: 26@ = float 26@ to_integer 
        0093: 27@ = integer 32@ to_float
        27@ -= 9500.0 
        27@ *= -0.358
        27@ += 179.0
        0092: 27@ = float 27@ to_integer
        if 26@ < 0
        then
            26@ = 0
        end
        if 27@ < 0
        then
            27@ = 0
        end
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 26@ 27@ 0 radius 2.0
    until 32@ > 10000
    Actor.DestroyInstantly(25@)
    0619: enable_actor $PLAYER_ACTOR collision_detection 1
    04D7: set_actor $PLAYER_ACTOR locked 0
    0AB2: ret 0
end
if 24@ == 2
then
    {0085: 27@ = 0@ // previous skin 
    0085: 28@ = 1@ // new skin
    
    04D7: set_actor $PLAYER_ACTOR locked 1 
    Player.CanMove($PLAYER_CHAR, 0)              
    
    wait 500
    009A: 30@ = create_actor_pedtype 21 model 27@ at -0.2326 -4.205 3.1172
    0245: set_actor 30@ walk_style_to "MAN" 
    0245: set_actor $PLAYER_ACTOR walk_style_to "MAN" 
    0172: 1@ = actor $PLAYER_ACTOR Z_angle 
    0173: set_actor 30@ Z_angle_to 1@
    0619: enable_actor $PLAYER_ACTOR collision_detection 0
    
    00A0: store_actor $PLAYER_ACTOR position_to 1@ 2@ 3@  
    09BC: set_char_coordinates_dont_warp_gang_no_offset 30@ at 1@ 2@ 3@
    
    09C7: change_player $PLAYER_CHAR model_to 28@
    0D10: set_actor $PLAYER_ACTOR alpha 0 
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
     //run "regeneration.cs" 1 0
    wait 1500
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
    0619: enable_actor 30@ collision_detection 0
    0619: enable_actor $PLAYER_ACTOR collision_detection 1} 
    
    0812: AS_actor $PLAYER_ACTOR perform_animation "regen_Fantastic" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
    0812: AS_actor 30@ perform_animation "regen_Fantastic" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
    Player.CanMove($PLAYER_CHAR, 1)
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
    066A: 10@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset -0.215 -0.06 0.30 rotation -45.0 0.0 -95.0 flag 1 
    066A: 12@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset   0.255 -0.06 0.30 rotation 45.0 0.0 -95.0 flag 1 
    066A: 13@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset 0.0 -0.09 0.8 rotation 0.0 0.0 0.0 flag 1
    04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 0.0 0.0
    064B: 11@ = create_particle "explosion_small" at 1@ 2@ 3@ type 1
    04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 -0.09 0.7
    064B: 14@ = create_particle "flame" at 1@ 2@ 3@ type 1  
 
    32@ = 0
    repeat
        wait 0
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0 
        0093: 26@ = integer 32@ to_float 
        26@ *= 0.0772
        0092: 26@ = float 26@ to_integer 
        0093: 27@ = integer 32@ to_float 
        27@ *= 0.0542
        0092: 27@ = float 27@ to_integer
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 26@ 27@ 0 radius 2.0 
        0613: 26@ = actor $PLAYER_ACTOR animation "regen_Fantastic" time      
    until 26@ > 0.33
    
    064C: make_particle 14@ visible
    064C: make_particle 11@ visible  
    064C: make_particle 10@ visible
    064C: make_particle 12@ visible  
    064C: make_particle 13@ visible
    call_scm_func @run_away 2 30@ 25@
    29@ = 0
    repeat
        wait 0
    
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0 
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 255 179 0 radius 2.0
        if and
            32@ > 4000
            29@ == 0
        then
            29@ += 1
            call_scm_func @run_away 5 30@ 25@ 1@ 2@ 3@ 
        end 
        if and
            32@ > 6000
            29@ == 1
        then
            29@ += 1
            call_scm_func @run_away 5 30@ 25@ 1@ 2@ 3@ 
        end 
  
        if 32@ > 7500
        jf continue
        0093: 20@ = integer 32@ to_float 
        20@ -= 7500.0
        20@ *= 0.1275
        
        0092: 20@ = float 20@ to_integer
        20@ += 140
        if 20@ > 255
        then
            20@ = 255
        end 
        0D10: set_actor $PLAYER_ACTOR alpha 20@
        if actor.Defined(30@)
        then
            actor.DestroyWithFade(30@)
        end          
    until 32@ > 9000
    0650: destroy_particle 10@ 
    0650: destroy_particle 11@ 
    0650: destroy_particle 12@ 
    0650: destroy_particle 13@ 
    0650: destroy_particle 14@ 
    0D10: set_actor $PLAYER_ACTOR alpha 255
    0337: set_actor $PLAYER_ACTOR visibility 1
    repeat
        wait 0
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0        
        0093: 26@ = integer 32@ to_float 
        26@ -= 9500.0
        26@ *= -0.51
        26@ += 255.0
        0092: 26@ = float 26@ to_integer 
        0093: 27@ = integer 32@ to_float
        27@ -= 9500.0 
        27@ *= -0.358
        27@ += 179.0
        0092: 27@ = float 27@ to_integer
        if 26@ < 0
        then
            26@ = 0
        end
        if 27@ < 0
        then
            27@ = 0
        end
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 26@ 27@ 0 radius 2.0
    until 32@ > 10000
    Actor.DestroyInstantly(25@)
    0619: enable_actor $PLAYER_ACTOR collision_detection 1
    04D7: set_actor $PLAYER_ACTOR locked 0
    0AB2: ret 0
end
if 24@ == 3
then
    {0085: 27@ = 0@ // previous skin 
    0085: 28@ = 1@ // new skin
    
    04D7: set_actor $PLAYER_ACTOR locked 1 
    Player.CanMove($PLAYER_CHAR, 0)              
    
    wait 500
    009A: 30@ = create_actor_pedtype 21 model 27@ at -0.2326 -4.205 3.1172
    0245: set_actor 30@ walk_style_to "MAN" 
    0245: set_actor $PLAYER_ACTOR walk_style_to "MAN" 
    0172: 1@ = actor $PLAYER_ACTOR Z_angle 
    0173: set_actor 30@ Z_angle_to 1@
    0619: enable_actor $PLAYER_ACTOR collision_detection 0
    
    00A0: store_actor $PLAYER_ACTOR position_to 1@ 2@ 3@  
    09BC: set_char_coordinates_dont_warp_gang_no_offset 30@ at 1@ 2@ 3@
    
    09C7: change_player $PLAYER_CHAR model_to 28@
    0D10: set_actor $PLAYER_ACTOR alpha 0 
     //run "regeneration.cs" 1 0
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
    wait 1500
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
    0619: enable_actor 30@ collision_detection 0
    0619: enable_actor $PLAYER_ACTOR collision_detection 1} 
    
    0812: AS_actor $PLAYER_ACTOR perform_animation "regen_War" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
    0812: AS_actor 30@ perform_animation "regen_War" IFP_file "DW" 4.0 loopA 0 lockX 0 lockY 0 lockF 0 time -1 // versionB
    Player.CanMove($PLAYER_CHAR, 1)
    02AB: set_actor $PLAYER_ACTOR immunities BP 1 FP 1 EP 1 CP 1 MP 1
    066A: 10@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset -0.315 0.15 0.365 rotation -60.0 90.0 0.0 flag 1 
    066A: 12@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset  0.375 0.15 0.365 rotation 60.0 90.0 0.0 flag 1 
    066A: 13@ = attach_particle "regenergy" to_actor $PLAYER_ACTOR with_offset 0.0 -0.09 0.8 rotation 0.0 0.0 0.0 flag 1
    04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 0.0 0.0
    064B: 11@ = create_particle "explosion_small" at 1@ 2@ 3@ type 1
    04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 -0.03 0.7
    064B: 14@ = create_particle "flame" at 1@ 2@ 3@ type 1  
 
    32@ = 0
    repeat
        wait 0
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0 
        0093: 26@ = integer 32@ to_float 
        26@ *= 0.06
        0092: 26@ = float 26@ to_integer 
        0093: 27@ = integer 32@ to_float 
        27@ *= 0.04
        0092: 27@ = float 27@ to_integer
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 26@ 27@ 0 radius 2.0 
        0613: 26@ = actor $PLAYER_ACTOR animation "regen_War" time      
    until 26@ > 0.247
    
    064C: make_particle 14@ visible
    
    repeat
        wait 0
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0 
        0093: 26@ = integer 32@ to_float 
        26@ *= 0.06
        0092: 26@ = float 26@ to_integer 
        0093: 27@ = integer 32@ to_float 
        27@ *= 0.04
        0092: 27@ = float 27@ to_integer
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 26@ 27@ 0 radius 2.0 
        0613: 26@ = actor $PLAYER_ACTOR animation "regen_War" time      
    until 26@ > 0.415
    
    064C: make_particle 11@ visible  
    064C: make_particle 10@ visible
    064C: make_particle 12@ visible  
    064C: make_particle 13@ visible
    call_scm_func @run_away 5 30@ 25@ 1@ 2@ 3@ 
    29@ = 0
    repeat
        wait 0
    
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0 
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 255 179 0 radius 2.0
        if and
            32@ > 5000
            29@ == 0
        then
            29@ += 1
            call_scm_func @run_away 5 30@ 25@ 1@ 2@ 3@ 
        end 
        if and
            32@ > 6000
            29@ == 1
        then
            29@ += 1
            call_scm_func @run_away 5 30@ 25@ 1@ 2@ 3@ 
        end 
  
        if 32@ > 7500
        jf continue
        0093: 20@ = integer 32@ to_float 
        20@ -= 7500.0
        20@ *= 0.1275
        
        0092: 20@ = float 20@ to_integer
        20@ += 140
        if 20@ > 255
        then
            20@ = 255
        end 
        0D10: set_actor $PLAYER_ACTOR alpha 20@
        if actor.Defined(30@)
        then
            actor.DestroyWithFade(30@)
        end          
    until 32@ > 8500
    0650: destroy_particle 10@ 
    0650: destroy_particle 11@ 
    0650: destroy_particle 12@ 
    0650: destroy_particle 13@ 
    0650: destroy_particle 14@ 
    0D10: set_actor $PLAYER_ACTOR alpha 255
    0337: set_actor $PLAYER_ACTOR visibility 1
    repeat
        wait 0
        04C4: store_coords_to 1@ 2@ 3@ from_actor $PLAYER_ACTOR with_offset 0.0 1.0 0.0        
        0093: 26@ = integer 32@ to_float 
        26@ -= 9500.0
        26@ *= -0.51
        26@ += 255.0
        0092: 26@ = float 26@ to_integer 
        0093: 27@ = integer 32@ to_float
        27@ -= 9500.0 
        27@ *= -0.358
        27@ += 179.0
        0092: 27@ = float 27@ to_integer
        if 26@ < 0
        then
            26@ = 0
        end
        if 27@ < 0
        then
            27@ = 0
        end
        09E5: create_flash_light_at 1@ 2@ 3@ RGB_mask 26@ 27@ 0 radius 2.0
    until 32@ > 10000
    Actor.DestroyInstantly(25@)
    0619: enable_actor $PLAYER_ACTOR collision_detection 1
    04D7: set_actor $PLAYER_ACTOR locked 0
    0AB2: ret 0
end
0AB2: ret 0

:run_away

const
    ped = 31@
end        
0A8D: 29@ = read_memory 0xB74490 size 4 virtual_protect 0
000A: 29@ += 0x4
0A8D: 29@ = read_memory 29@ size 4 virtual_protect 0
for 30@ = 0 to 35584 step 0x100
    0A8D: ped = read_memory 29@ size 1 virtual_protect 0
    000A: 29@ += 0x1
    if and
        0029:  ped >= 0x00 
        001B:  0x80 > ped
    then 
        005A: ped += 30@
        if and 
            87D6:   not ped == $PLAYER_ACTOR // integer vars 
            803B: not ped == 0@
            803B: not ped == 1@
            86EE:  NOT actor ped in_group $PLAYER_GROUP 
            Actor.Defined(ped)
        then
            05DA: AS_actor ped run_away_in_panic_from 2@ 3@ 4@ away_radius 1000.0 timelimit 15000 
            if $ONMISSION == 0
            then
                Actor.RemoveReferences(ped)
            end
        end
    end
end
0AB2: ret 0

//////////////////////////////////////////////////////////

:camera_effect
thread "dwregca"
if 1@ == 0
then
    0460: set_camera_transverse_delay 0.0 time 6000
    04C4: store_coords_to 0@ 1@ 2@ from_actor $PLAYER_ACTOR with_offset 0.5 2.0 0.75
    
    015F: set_camera_position 0@ 1@ 2@ rotation 0.0 0.0 0.0 
    04C4: store_coords_to 0@ 1@ 2@ from_actor $PLAYER_ACTOR with_offset 0.0 0.0 0.75
    
    0160: set_camera_point_at 0@ 1@ 2@ mode 1 
    wait 5800
    0460: set_camera_transverse_delay 0.0 time 4000 
    
    04C4: store_coords_to 0@ 1@ 2@ from_actor $PLAYER_ACTOR with_offset 0.0 0.5 0.75
    015F: set_camera_position 0@ 1@ 2@ rotation 0.0 0.0 0.0 
    04C4: store_coords_to 0@ 1@ 2@ from_actor $PLAYER_ACTOR with_offset 0.0 0.0 0.75
    0160: set_camera_point_at 0@ 1@ 2@ mode 1 
    wait 6200
    0460: set_camera_transverse_delay 0.0 time 500 
    04C4: store_coords_to 0@ 1@ 2@ from_actor $PLAYER_ACTOR with_offset -1.0 4.5 2.0
    015F: set_camera_position 0@ 1@ 2@ rotation 0.0 0.0 0.0 
    04C4: store_coords_to 0@ 1@ 2@ from_actor $PLAYER_ACTOR with_offset 0.0 0.0 0.6
    0160: set_camera_point_at 0@ 1@ 2@ mode 1 
    wait 6000
    04C4: store_coords_to 0@ 1@ 2@ from_actor $PLAYER_ACTOR with_offset -0.55 0.55 1.1
    015F: set_camera_position 0@ 1@ 2@ rotation 0.0 0.0 0.0 
    04C4: store_coords_to 0@ 1@ 2@ from_actor $PLAYER_ACTOR with_offset 0.0 0.0 0.6
    0160: set_camera_point_at 0@ 1@ 2@ mode 2 
    wait 4000
    Camera.Restore()
end
end_custom_thread


//////////////////////////////////////////////////////////

:regen_texture
thread "dwregtx"
0AB3: var 53 = 1
10@ = 100
1@ = 0
11@ = 1000
repeat
    32@ = 0
    repeat
        wait 0
        
        03E3: set_texture_to_be_drawn_antialiased 1
        03F0: enable_text_draw 1
        0093: 12@ = integer 10@ to_float 
        12@ *= 2.57575757
        0092: 12@ = float 12@ to_integer 
 
        
        //038D: draw_texture 11 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 12@
        
        0093: 15@ = integer 32@ to_float 
        0093: 13@ = integer 11@ to_float
        13@ /= 2.0
        if 0025: 15@ > 13@
        then
        //14@ = 128.0
            13@ *= -2.0
            0093: 14@ = integer 12@ to_float
            0073: 14@ /= 13@
            006B: 15@ *= 14@
            0092: 15@ = float 15@ to_integer
            005A: 15@ += 12@
            if 15@ < 0
            then
                15@ = 0
            end
            038D: draw_texture 10 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 15@
            0062: 15@ -= 12@
            15@ *= -1
            038D: draw_texture 11 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 15@
           // show_text "down %d %d" 1000 12@ 15@
        else
            13@ *= 2.0
            0093: 14@ = integer 12@ to_float
            0073: 14@ /= 13@
            006B: 15@ *= 14@
            0092: 15@ = float 15@ to_integer
            038D: draw_texture 10 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 15@
            0062: 15@ -= 12@
            15@ *= -1
            038D: draw_texture 11 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 15@
            //show_text "up %d %d" 1000 12@ 15@
        end 
        
    until 002D: 32@ >= 11@
    
    10@ -= 1
    
    //show_text "%d %d" 1000 10@ 11@
until 10@ < 1
03E3: set_texture_to_be_drawn_antialiased 1
//03F0: enable_text_draw 0
//038D: draw_texture 11 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 255
//038D: draw_texture 10 position 320.0 220.0 size 640.0 480.0 RGBA 255 255 255 255
0AB3: var 53 = 0
end_custom_thread